<style>
	/*Table 寬度滾動*/
	#search_c .table-responsive {
		display: block;
		width: 100%;
		overflow-x: auto;
	}

	/*Table 自動隱藏*/
	#search_c .table-responsive th,
	#search_c .table-responsive td {
		text-overflow: ellipsis;
		white-space: nowrap;
		overflow: hidden;
	}

	/*Table 表格固定*/
	#search_c .fixedC1 {
		left: 0px;
		position: sticky;
	}

	#search_c .fixedCt {
		position: sticky;
		top: 0px;
		z-index: 5;
	}

	/*Table 每隔表格內_框線*/
	#search_c .table-bordered td,
	#search_c .table-bordered th {
		border: 1px solid #1b76fd;
		padding: 2px;
	}

	/*Table 表格外框線*/
	#search_c #search_cr table {
		min-height: 300px;
		max-height: 400px;
		border-collapse: separate;
		border-spacing: 0px;
	}

	/*Table 表格外框線*/
	#search_c #search_dcr table {
		min-height: 300px;
		max-height: 400px;
		border-collapse: separate;
		border-spacing: 0px;
	}

	/*Table 表格內 背景色*/
	#search_c .table-white {
		--bs-table-bg: #fff;
	}

	/*覆寫換色*/
	.table-hover>tbody>tr:hover>* {
		--bs-table-accent-bg: #0d6efd40;
		color: var(--bs-table-hover-color);
	}

	/*標題色彩*/
	#search_c .title_color {
		background-color: #cfe2ff;
	}

	#search_c .pink_color {
		background-color: var(--bs-orange);
	}



	/*直立式呈現邊字*/
	#search_c .wlr {
		writing-mode: vertical-lr;
		width: 20px;
	}

	/*checkbox_32*/
	#search_c .checkbox_32 {
		width: 32px;
		height: 32px;
	}

	/*checkbox_24*/
	#search_c .checkbox_24 {
		width: 24px;
		height: 24px;
	}

	#search_c .checkbox_20 {
		width: 20px;
		height: 20px;
	}

	#search_c .checkbox_16 {
		width: 16px;
		height: 16px;
	}
</style>
<div id="search_c" class="row p-0 m-0">
	<!-- 查詢面板 -->
	<div id="search_c_item" class="col-12 p-1">
		<div class="col-12 p-0 m-0 lh-1 text-start rounded-top bg-success text-white">
			<i class="btn btn-outline-white p-0 pr-1 pl-1 bi bi-dash-square" data-bs-toggle="collapse"
				data-bs-target="#search_c_item_open" aria-expanded="false" style="width: 22px; height: 24px;"></i>
		</div>
		<div class="row m-0 collapse show" id="search_c_item_open">
			<b class="p-0 m-0 lh-1 wlr bg-success text-white"> Search </b>
			<div id="searchItem" class="col border border-primary  row m-0 p-0 shadow-sm">
				<div class="col-6 searchTextEx col-md-1 p-1 d-none">
					<div class=" border border-secondary rounded">
						<div class="searchTitle title_color fw-bolder rounded-top">Search1</div>
						<div class="p-1">
							<input class="col-12 m-0 p-1 border border-dark form-control" type=text id="ex_id"
								name="ex_name" placeholder="Ex:123" autofocus>
						</div>
					</div>
				</div>
				<div class="col-6 searchSelectEx col-md-1 p-1 d-none">
					<div class=" border border-secondary rounded">
						<div class="searchTitle title_color fw-bolder rounded-top">Search2</div>
						<div class="p-1">
							<select class="col-12 m-0 p-1 border border-dark form-select" id="ex_id2" name="ex_name2">
								<option class="selectEx" value="" selected="selected">select(請選擇)</option>
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 控制面板 -->
	<div id="search_c_controller" class="col-12 p-1 ">
		<div class="col-12 p-0 m-0 lh-1 text-start rounded-top bg-primary text-white">
			<i class="btn btn-outline-white p-0 pr-1 pl-1 bi bi-dash-square" data-bs-toggle="collapse"
				data-bs-target="#search_c_controller_open" aria-expanded="false" style="width: 22px; height: 24px;"></i>
		</div>
		<div id="search_c_controller_open" class="row m-0 collapse show">
			<b class="p-0 m-0 lh-1 wlr bg-primary text-white"> Console </b>
			<div class="col border border-primary row m-0 p-0 shadow-sm justify-content-between">
				<div class="col-12 col-lg-5 p-1">
					<div class=" border border-secondary rounded">
						<div class="title_color fw-bolder rounded-top">Execution</div>
						<div class="row m-0">
							<button id="btn_production" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-info">
								<b>Production<br>import()
								</b>
							</button>
							<button id="btn_bom" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-secondary">
								<b>BOM<br>import()
								</b>
							</button>
							<button id="btn_order" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-warning">
								<b>Order<br>import(AR)
								</b>
							</button>
							<button id="btn_invalid" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-danger">
								<b>Void <br>documents(AD)
								</b>
							</button>
						</div>
					</div>
				</div>
				<div class="col-6 col-lg-3 p-1">
					<div class=" border border-secondary rounded">
						<div class="title_color fw-bolder rounded-top">Action</div>
						<div class="row m-0">
							<button id="btn_intoForm" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-info">
								<b>Preview<br>()
								</b>
							</button>
							<button id="btn_saveForm" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-success">
								<b>Save<br>(AU/AC/AD)
								</b>
							</button>
							<button id="btn_printerForm" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-primary">
								<b>Printer<br>form
								</b>
							</button>
						</div>
					</div>
				</div>
				<div class="col-6 col-lg-3 p-1">
					<div class=" border border-secondary rounded">
						<div class="title_color fw-bolder rounded-top">Search</div>
						<div class="row m-0">
							<div class="lh-1 col p-1 m-1 border border-primary rounded">
								<input id="btn_send_auto" alt="" title="" type="checkbox"
									class="m-0 form-check-input checkbox_16 border border-dark"> <br> <b
									style="font-size: 12px;">Auto(30s)</b>
							</div>
							<button id="btn_send" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-success">
								<b>Query<br>(AR)
								</b>
							</button>
							<button id="btn_clearAll" type="button"
								class="lh-1 col p-1 m-1  btn btn-sm btn-outline-warning">
								<b>Clear<br>all()
								</b>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 編輯過程 -->
	<div id="modify_cr" class="col-12 m-0 p-1">
		<div class="col-12 p-0 m-0 lh-1 text-start rounded-top bg-warning text-white">
			<i class="btn btn-outline-white p-0 pr-1 pl-1 bi bi-dash-square" data-bs-toggle="collapse"
				data-bs-target="#modify_cr_open" aria-expanded="false" style="width: 22px; height: 24px;"></i>
		</div>
		<div id="modify_cr_open" class="row m-0 shadow-sm collapse show">
			<b class="p-0 m-0 lh-1 wlr bg-warning text-white">Modify choose</b>
			<div class="col p-0">
				<div class="row m-0">
					<!--編輯-->
					<div class="col-12 col-lg-6 border border-primary row m-0 p-1">
						<!--1-->
						<div class="col-6 p-1 col-lg-3">
							<div id="bomDefinition" class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">model(模式)</div>
								<div class="p-1">
									<select class="col-12 m-0 p-1 border border-dark form-select">
										<option class="" value="bom" selected="selected">一般模式(General)</option>
										<option class="" value="definition">自定義(Custom)</option>
									</select>
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphpon" class=" border border-secondary rounded">
								<div class="searchTitle bg-warning fw-bolder rounded-top">製令單</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										placeholder="Ex:A512-99990101001">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphonb" class="border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">訂單號</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										placeholder="Ex:US110762450">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphhdate" class="border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">預計出貨</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="date"
										placeholder="Ex:2090-12-12">
								</div>
							</div>
						</div>
						<!--2-->
						<div class="col-6 p-1 col-lg-3">
							<div id="sphbpmnb" class="border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">公司BOM號</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										placeholder="Ex:90-317-R141010">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphobpmnb" class="border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">客戶BOM號</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										placeholder="Ex:313T-51-49">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphbpmmodel" class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">機型</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										placeholder="Ex:313T">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div id="sphoqty" class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">生產數量</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal"
										type="number" value="1">
								</div>
							</div>
						</div>
						<!--3-->
						<div class="col-6 p-1 col-lg-3">
							<div class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">客戶名稱</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										id="sphbpmnb" name="sphbpmnb" placeholder="Ex:BOM號?" autofocus="">
								</div>
							</div>
						</div>
						<div class="col-6 p-1 col-lg-3">
							<div class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">國家名稱</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" type="text"
										id="sphbpmnb" name="sphbpmnb" placeholder="Ex:BOM號?" autofocus="">
								</div>
							</div>
						</div>
						<!--4:自訂需裝配-->
						<div class="col-12 p-1"></div>
						<div class="col-6 p-1">
							<div class=" border border-secondary rounded">
								<div class="searchTitle pink_color fw-bolder rounded-top">產品規格-需裝配</div>
								<div class="p-1">
									<select class="col-12 m-0 p-1 border border-dark form-select" id="bom_items"
										name="bom_items">
										<option class="selectItemsEx" value="" selected="selected">select(請選擇)</option>
									</select>
								</div>
							</div>
						</div>
						<div class="col-2 p-1">
							<div class=" border border-secondary rounded">
								<div class="searchTitle pink_color fw-bolder rounded-top">Qty</div>
								<div class="p-1">
									<input class="col-12 m-0 p-1 border border-dark form-control searchVal" value="0"
										type="number" id="btn_bom_item_qty" name="btn_bom_item_qty">
								</div>
							</div>
						</div>
						<div class="col-4 p-1">
							<div class=" border border-secondary rounded">
								<div class="searchTitle pink_color fw-bolder rounded-top">Add/Remove</div>
								<div class="p-1">
									<button id="btn_bom_item_add" type="button"
										class="lh-1 col p-1 m-1 btn btn-sm btn-outline-success">
										<b>Add</b>
									</button>
									<button id="btn_bom_item_remove" type="button"
										class="lh-1 col p-1 m-1 btn btn-sm btn-outline-danger">
										<b>Remove</b>
									</button>
								</div>
							</div>
						</div>
						<!--5-->
						<div class="col-12 p-1">
							<div class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">備註-包裝說明</div>
								<div class=" p-1" id="sphscpackage">
									<div class="row m-0 p-0">
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox1" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control"
												value="Power cord" type="text" id="sphscpackage_value1"
												name="sphscpackage_value1">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox2" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="BOG"
												type="text" id="sphscpackage_value2" name="sphscpackage_value2">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox3" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="License"
												type="text" id="sphscpackage_value3" name="sphscpackage_value3">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox4" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="BOX Label"
												type="text" id="sphscpackage_value4" name="sphscpackage_value4">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox5" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="Bulk Pack"
												type="text" id="sphscpackage_value5" name="sphscpackage_value5">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox6" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control"
												value="Retail Pack" type="text" id="sphscpackage_value6"
												name="sphscpackage_value6">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox7" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="作業系統OS"
												type="text" id="sphscpackage_value7" name="sphscpackage_value7">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox8" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="NA1"
												type="text" id="sphscpackage_value8" name="sphscpackage_value8">
										</div>
										<div class="col-6 col-lg-4 row m-0 p-1">
											<input class="m-0 form-check-input checkbox_32 border border-dark"
												id="sphscpackage_checkbox9" alt="" title="" type="checkbox"
												checked="checked">
											<input class="col m-0 p-1 border border-dark form-control" value="NA2"
												type="text" id="sphscpackage_value9" name="sphscpackage_value9">
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-12 p-1">
							<div class=" border border-secondary rounded">
								<div class="searchTitle title_color fw-bolder rounded-top">備註-生管說明</div>
								<div class="p-1">
									<textarea class="col-12 m-0 p-1 border border-dark form-control searchVal" rows="6"
										id="sphscnote" name="sphscnote" placeholder="Ex:3年保固 貼先 4F"></textarea>
								</div>
							</div>
						</div>
					</div>
					<!--預覽:因為需要開立打印視窗 所以使用原始Style-->
					<div id="printNotes"
						class="justify-content-center row col-12 col-lg-6 border border-primary m-0 p-1"
						style="max-height: 686px;overflow: auto;">
						<div class=""
							style="height:880px;width:600px;min-width:600px;border: 1px solid #000000;padding: 0px;">
							<div style="border: 1px solid #000000;">
								<h4 style="padding: 5px;margin: 0px;text-align: center;"><b>生產注意事項</b></h4>
							</div>
							<div
								style="display:flex;flex-wrap: wrap;justify-content: space-between;border: 1px solid #000000;text-align: center;">
								<div style="width: 10%;"><b>製令</b></div>
								<div style="width: 25%;overflow: hidden;">AXXX-250101001</div>
								<div style="width: 10%;border-left: 1px solid #000000;"><b>訂單</b></div>
								<div style="width: 20%;overflow: hidden;">XXX1111</div>
								<div style="width: 15%;border-left: 1px solid #000000;"><b>預計出貨</b></div>
								<div style="width: 20%;overflow: hidden;">2099-01-01</div>
							</div>
							<div
								style="display:flex;flex-wrap: wrap;justify-content: space-between;border-bottom: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000;text-align: center;">
								<div style="width: 10%;"><b>客戶</b></div>
								<div style="width: 25%;overflow: hidden;">ASUS</div>
								<div style="width: 10%;border-left: 1px solid #000000;"><b>國家</b></div>
								<div style="width: 20%;overflow: hidden;">Taiwan</div>
								<div style="width: 15%;border-left: 1px solid #000000;"></div>
								<div style="width: 20%;overflow: hidden;"></div>
							</div>
							<div
								style="display:flex;flex-wrap: wrap;justify-content: space-between;border-bottom: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000;text-align: center;">
								<div style="width: 10%;"><b>品號</b></div>
								<div style="width: 25%;overflow: hidden;">90-345-XXXXXXX</div>
								<div style="width: 10%;border-left: 1px solid #000000;"><b>型號</b></div>
								<div style="width: 20%;overflow: hidden;">340TR</div>
								<div style="width: 15%;border-left: 1px solid #000000;"><b>需生產量</b></div>
								<div style="width: 20%;overflow: hidden;">500</div>
							</div>
							<!--產品資訊-->
							<div
								style="border: 1px solid #000000;display:flex;flex-wrap: wrap;justify-content: space-between;">
								<div
									style="text-align: center;writing-mode: vertical-lr;text-orientation: upright;font-size: 6px;">
									產品規格 & 專案經理說明
								</div>
								<div style="border-left: 1px solid #000000;width: 98%;">
									<!--規格內容-->
									<div style="height: 448px; border-bottom: 1px solid #000000;padding-top: 2px;
										           display: grid;overflow: hidden;grid-template-rows: repeat(20, 1fr); 
										           grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
										           grid-auto-flow: column;gap: 2px;font-size: 14px;">
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											<b>RAM </b>RAM,2G,78.A2G72.405,APACER(x2)
										</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											2</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											3</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											4</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											5</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											6</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											7</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											8</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											9</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											10</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											11</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											12</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											13</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											14</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											15</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											16</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											17</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											18</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											19</div>
										<div
											style="overflow: hidden; text-align: start;height: 20px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">
											<b>CPU </b>CPU,N97,Intel
										</div>
									</div>
									<div id="sphbisitemNot" style="overflow: hidden;height: 50px; border-bottom: 1px solid #000000;
										display:flex;flex-wrap: wrap;justify-content:start;font-size: 14px;">
										<span style="height: 16px;"><b>注意!!不裝配：</b></span>
										<span id="sphbisitemExNot_val"
											style="height: 16px; border-right: 1px solid #00000060; border-bottom: 1px solid #00000060;">N/A</span>


									</div>
									<div
										style="height: 90px;display:flex;flex-wrap: wrap;justify-content:space-between;">
										<div style="width: 10%; text-align: center;"><b>專案<br>備註<br>
												<p style="font-size: 8px;line-height: 8px;margin: 0px;">Project
													instructions</p>
											</b></div>
										<div style="width: 90%;padding: 2px;">
											<textarea id="sphpmnote_val"
												style="width: 100%;font-size: 14px;line-height: 16px;" rows="5"
												disabled="disabled">N/A ⁕產品狀態:技轉單 ⁕主機板本:R1.2</textarea>
										</div>
									</div>
								</div>
							</div>
							<!--生產資訊-->
							<div
								style="display:flex;flex-wrap: wrap;justify-content: space-between;border: 1px solid #000000;">
								<div
									style="text-align: center;writing-mode: vertical-lr;text-orientation: upright;font-size: 6px;">
									生產管理
								</div>
								<div style="border-left: 1px solid #000000;width: 98%;">
									<div
										style="height: 70px;border-bottom: 1px solid #000000;display:flex;flex-wrap: wrap;justify-content:space-between;">
										<div style="width: 10%; text-align: center;"><b>包裝<br>配置
												<p style="font-size: 8px;line-height: 8px;margin: 0px;">package
													configuration</p>
											</b></div>
										<div
											style="width: 90%;display:flex;flex-wrap: wrap;justify-content: space-between;pointer-events: none;">
											<div id="pkg_checkbox1"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox" checked>
												<span>Power cord</span>
											</div>
											<div id="pkg_checkbox2"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>BOG</span>
											</div>
											<div id="pkg_checkbox3"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>License</span>
											</div>
											<div id="pkg_checkbox4"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>BOX Label</span>
											</div>
											<div id="pkg_checkbox5"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>Bulk Pack</span>
											</div>
											<div id="pkg_checkbox6"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>Retail Pack</span>
											</div>
											<div id="pkg_checkbox7"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>作業系統OS</span>
											</div>
											<div id="pkg_checkbox8"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>NA1</span>
											</div>
											<div id="pkg_checkbox9"
												style="width: 33%;text-align: start;font-size: 14px;">
												<input type="checkbox">
												<span>NA2</span>
											</div>
										</div>
									</div>
									<div
										style="height: 90px;display:flex;flex-wrap: wrap;justify-content:space-between;">
										<div style="width: 10%; text-align: center;"><b>生管<br>備註
												<p style="font-size: 8px;line-height: 8px;margin: 0px;">Production
													instructions</p>
											</b></div>
										<div style="width: 90%;padding: 2px;">
											<textarea id="sphscnote_val"
												style="width: 100%;font-size: 14px;line-height: 16px;" rows="5"
												disabled="disabled">N/A ⁕說明1 ⁕說明2</textarea>
										</div>
									</div>
								</div>
							</div>
							<!--其他資訊-->
							<div style="display:flex;flex-wrap: wrap;justify-content:space-between;
								border: 1px solid #000000;font-size: 6px;">
								<div>
									<span>產品類:</span><span>product/accessories</span>
								</div>
								<div>
									<span>客戶品號:</span><span>ACC-123456</span>
								</div>
								<div>
									<span>建單人:</span><span></span><span>
								</div>
								<div>
									<span>產品負責:</span></span><span>
								</div>
								<div>
									<span>單據編號:</span><span>QR-701-06</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 查詢結果 -->
	<div id="search_cr" class="col-12 m-0 p-1">
		<div class="col-12 p-0 m-0 lh-1 text-start rounded-top bg-info text-white">
			<i class="btn btn-outline-white p-0 pr-1 pl-1 bi bi-dash-square" data-bs-toggle="collapse"
				data-bs-target="#search_cr_open" aria-expanded="false" style="width: 22px; height: 24px;"></i>
		</div>
		<div id="search_cr_open" class="row m-0 shadow-sm collapse show">
			<b class="p-0 m-0 lh-1 wlr bg-info text-white">Production Records</b>
			<table
				class="col m-0 p-0 border border-primary table table-striped table-hover table-sm table-bordered border-primary table-responsive table-style shadow-sm">
				<thead class="table-primary fixedCt">
					<tr>
						<th class="fixedC1" style="min-width: 40px;">
							<div>
								<button id="exthAll" type="button" class="lh-1 col p-1 m-0 btn btn-sm btn-outline-dark">
									<b>Ｃ</b>
								</button>
							</div>
						</th>
						<th class="exTheadth d-none" style="min-width: 100px;">N/A</th>
					</tr>
				</thead>
				<tbody class="table-white">
					<tr class="exTbodyTr">
						<th class="fixedC1 exTbodyTh" style="max-width: 40px;">
							<div>
								<input disabled="disabled" alt="row_x" title="IKey_GKey" type="radio"
									class="m-0 form-check-input checkbox_24 border border-dark">
							</div>
						</th>
						<td class="exTbodytd d-none" style="max-width: 100px"></td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	<!-- 查詢-細節結果 -->
	<div id="search_dcr" class="col-12 m-0 p-1">
		<div class="col-12 p-0 m-0 lh-1 text-start rounded-top bg-secondary text-white">
			<i class="btn btn-outline-white p-0 pr-1 pl-1 bi bi-dash-square" data-bs-toggle="collapse"
				data-bs-target="#search_dcr_open" aria-expanded="false" style="width: 22px; height: 24px;"></i>
		</div>
		<div id="search_dcr_open" class="row m-0 shadow-sm collapse show">
			<b class="p-0 m-0 lh-1 wlr  bg-secondary text-white">BOM List</b>
			<table
				class=" col m-0 p-0 border border-primary  table table-striped table-hover table-sm table-bordered border-primary table-responsive table-style shadow-sm">
				<thead class="table-primary fixedCt">
					<tr>
						<th class="fixedC1" style="min-width: 40px;">
							<div>
								<button id="exthDetailAll" type="button"
									class="lh-1 col p-1 m-0 btn btn-sm btn-outline-dark">
									<b>Ｃ</b>
								</button>
							</div>
						</th>
						<th class="exTheadth d-none" style="min-width: 100px;">N/A</th>
					</tr>
				</thead>
				<tbody class="table-white">
					<tr class="exDetailTbodyTr">
						<th class="fixedC1 exTbodyTh" style="max-width: 40px;">
							<div>
								<input type="radio" alt="row_x" title="IKey_GKey" name="radio_dt"
									class="m-0 form-check-input checkbox_24 border border-dark">
							</div>
						</th>
						<td class="exTbodytd d-none" style="max-width: 100px"></td>
					</tr>

				</tbody>
			</table>
		</div>
	</div>
</div>
<script type="text/javascript">
	//宣告
	//console.log("search.html(init)");
	search = {
		//資料
		data: {
			marks: {},//有選取的IKeyGKey
			markDetails: {},//有選取的IKeyGKey
			entityFormatJson: {},//查詢格式
			btn_send_auto: "",//自動傳送
			//換頁設置
			searchPageSet: {
				total: 1000,//批次數量(1-1000)
				batch: 0,//第幾批次(1-1000)
				pageNew: 1,//單前頁碼(1-50)
				pageSize: 200,//每頁數量(1-20)
				entityJsons: [],//資料
				entityDetailJsons: [],//細節資料
				entityIKey: "",//ID
				entityGKey: "",//GID
				entityDateTime: "",//是時間格式的欄位
			},
			searchSet: {},
		},
		//方法
		methods: {
			create() {
				//==========================第一次載入==========================
				//Step0.初始化
				console.log("search.html(created)");
				//查詢格式
				search.data.entityFormatJson = JSON.parse(main.resq_data['entityFormatJson']);
				//查詢項目 
				let searchSetJson = JSON.parse(main.resq_data['searchSet']);
				//console.log(searchSetJson);
				//資料內容
				search.data.searchPageSet.entityJsons = JSON.parse(main.resq_data['entityJson']);
				search.data.searchPageSet.entityDetailJsons = JSON.parse(main.resq_data['entityDetailJson']);
				search.data.entityIKey = main.resq_data['entityIKeyGKey'].split("_")[0];
				search.data.entityGKey = main.resq_data['entityIKeyGKey'].split("_")[1];
				search.data.entityDateTime = main.resq_data['entityDateTime'];
				search.data.searchSet = searchSetJson['searchSet'];
				//按鈕權限?
				let p = $("#nav_functional_unit").attr("alt").split("<_>")[2];
				let ps = Array.from(p);

				if (ps[10] != 1) {//查詢(AR)10
					$("#btn_send").addClass("disabled");
				} if (ps[9] != 1) {//修改(AU)9
					$("#btn_modify").addClass("disabled");
				} if (ps[8] != 1) {//新增(AC)8
					$("#btn_create").addClass("disabled");
					$("#btn_saveAs").addClass("disabled");
				} if (ps[7] != 1) {//作廢(AD)7
					$("#btn_invalid").addClass("disabled");
				} if (ps[6] != 1) {//移除(DD)6
					$("#btn_delete").addClass("disabled");
				}

				//Step1.查詢結果標題-排序
				let resultThead = searchSetJson['resultThead'];
				let resultDetailThead = searchSetJson['resultDetailThead'];
				resultThead = main.methods.orderedSort(resultThead);
				resultDetailThead = main.methods.orderedSort(resultDetailThead);
				//Step2.查詢結果標題-資料
				let check1 = true;
				Object.keys(resultThead).forEach(function (k) {
					//console.log(k + ' - ' + resultThead[k]);
					//複製格式
					let exTheadth = $('#search_cr_open .exTheadth').clone();
					let exTbodytd = $('#search_cr_open .exTbodytd').clone();
					exTheadth.removeClass('exTheadth');
					exTheadth.removeClass('d-none')
					exTheadth.addClass('titTheadth');
					//
					exTbodytd.removeClass('exTbodytd');
					exTbodytd.removeClass('d-none')
					exTbodytd.addClass('valTbodytd');
					exTbodytd.addClass(resultThead[k].cellName);
					//固定第一格式
					if (check1 && resultThead[k].show == 1) {
						check1 = false;
						exTheadth.addClass('fixedC1');
						exTheadth.css('left', "40px");
						exTbodytd.addClass('fixedC1');
						exTbodytd.css('left', "40px");
					}
					//如果有翻譯
					if (resultThead[k].cellLanguage != '') {
						let cellName = JSON.parse(resultThead[k].cellLanguage)[$('#menu_login_language').text()];
						exTheadth.text(cellName == "" ? resultThead[k].cellName : cellName);//有可能內容是空的
						exTheadth.css('minWidth', resultThead[k].width + "px");
						exTbodytd.css('maxWidth', resultThead[k].width + "px");
					} else {
						exTheadth.text(resultThead[k].cellName);
						exTheadth.css('minWidth', resultThead[k].width + "px");
						exTbodytd.css('maxWidth', resultThead[k].width + "px");
					}
					//如果隱藏
					if (resultThead[k].show == 0) {
						exTheadth.addClass('d-none');
						exTbodytd.addClass('d-none');
					}
					//添加
					$('#search_cr_open .exTheadth').before(exTheadth);
					$('#search_cr_open .exTbodytd').before(exTbodytd);
				});
				//Step2.查詢結果標題(細節)-資料
				check1 = true;

				Object.keys(resultDetailThead).forEach(function (k) {
					//console.log(k + ' - ' + resultDetailThead[k]);
					//複製格式
					let exTheadth = $('#search_dcr_open .exTheadth').clone();
					let exTbodytd = $('#search_dcr_open .exTbodytd').clone();
					exTheadth.removeClass('exTheadth');
					exTheadth.removeClass('d-none')
					exTheadth.addClass('titTheadth');
					//
					exTbodytd.removeClass('exTbodytd');
					exTbodytd.removeClass('d-none')
					exTbodytd.addClass('valTbodytd');
					exTbodytd.addClass(resultDetailThead[k].cellName);
					//固定第一格式
					if (check1 && resultDetailThead[k].show == 1) {
						check1 = false;
						exTheadth.addClass('fixedC1');
						exTheadth.css('left', "40px");
						exTbodytd.addClass('fixedC1');
						exTbodytd.css('left', "40px");
					}
					//如果有翻譯
					if (resultDetailThead[k].cellLanguage != '') {
						let cellName = JSON.parse(resultDetailThead[k].cellLanguage)[$('#menu_login_language').text()];
						exTheadth.text(cellName == "" ? resultDetailThead[k].cellName : cellName);
						exTheadth.css('minWidth', resultDetailThead[k].width + "px");
						exTbodytd.css('maxWidth', resultDetailThead[k].width + "px");
					} else {
						exTheadth.text(resultDetailThead[k].cellName);
						exTheadth.css('minWidth', resultDetailThead[k].width + "px");
						exTbodytd.css('maxWidth', resultDetailThead[k].width + "px");
					}
					//如果隱藏
					if (resultDetailThead[k].show == 0) {
						exTheadth.addClass('d-none');
						exTbodytd.addClass('d-none');
					}
					//添加
					$('#search_dcr_open .exTheadth').before(exTheadth);
					$('#search_dcr_open .exTbodytd').before(exTbodytd);
				});

				//Step3.查詢內容-格式
				for (let b = 1; b <= search.data.searchPageSet.pageSize; b++) {
					let exTbodyTr = $('#search_cr .exTbodyTr').clone();
					let exDetailTbodyTr = $('#search_dcr .exDetailTbodyTr').clone();
					//
					exTbodyTr.removeClass('exTbodyTr');
					exTbodyTr.removeClass('d-none');
					exTbodyTr.addClass('valTbodyTr_' + b);
					exTbodyTr.find('input').attr("alt", "row_" + b);
					//
					exDetailTbodyTr.removeClass('exDetailTbodyTr');
					exDetailTbodyTr.removeClass('d-none');
					exDetailTbodyTr.addClass('valTbodyDetailTr_' + b);
					exDetailTbodyTr.find('input').attr("alt", "row_" + b);

					$('#search_cr .exTbodyTr').before(exTbodyTr);
					$('#search_dcr .exDetailTbodyTr').before(exDetailTbodyTr);

				}
				$('#search_cr .exTbodyTr').addClass('d-none');
				$('#search_cr .exDetailTbodyTr').addClass('d-none');

				//Step4.查詢條件
				for (let t = 0; t < searchSetJson['searchSet'].length; t++) {
					let searchSet = searchSetJson['searchSet'][t];
					let searchTextEx = "";
					let searchSelectEx = "";
					let selectEx = "";
					//不顯示
					if (!searchSet['show']) {
						continue;
					}
					if (searchSet['type'] != 'select') {
						//一般文字
						searchTextEx = $('#search_c_item .searchTextEx').clone();
						searchTextEx.removeClass("searchTextEx");
						searchTextEx.removeClass("col-md-1");
						searchTextEx.removeClass("d-none");
						searchTextEx.addClass(searchSet['width'].replaceAll("_", "-"));
						searchTextEx.find('input').attr("id", searchSet['searchName']);
						searchTextEx.find('input').attr("name", searchSet['searchName']);
						searchTextEx.find('input').attr("placeholder", searchSet['placeholder']);
						searchTextEx.find('input').addClass("searchVal");
						Object.keys(resultThead).forEach(function (k) {

							//如果有翻譯
							if (k.split("_")[1] == (searchSet['searchName'])) {
								if (resultThead[k].cellLanguage != '') {
									let cellName = JSON.parse(resultThead[k].cellLanguage)[$('#menu_login_language').text()];
									searchTextEx.find('.searchTitle').text(cellName == "" ? searchSet['searchName'] : cellName);
								} else {
									searchTextEx.find('.searchTitle').text(searchSet['searchName']);
								}
							}
						});
					} else {
						//選擇選單
						searchSelectEx = $('.searchSelectEx').clone();
						searchSelectEx.removeClass("searchSelectEx");
						searchSelectEx.removeClass("col-md-1");
						searchSelectEx.removeClass("d-none");
						searchSelectEx.addClass(searchSet['width'].replaceAll("_", "-"));
						searchSelectEx.find('select').attr("id", searchSet['searchName']);
						searchSelectEx.find('select').attr("name", searchSet['searchName']);
						searchSelectEx.find('select').addClass("searchVal");
						//查詢欄位
						Object.keys(resultThead).forEach(function (k) {
							//如果有翻譯
							if (k.indexOf(searchSet['searchName']) >= 0) {
								if (resultThead[k].cellLanguage != '') {
									let cellName = JSON.parse(resultThead[k].cellLanguage)[$('#menu_login_language').text()];
									searchSelectEx.find('.searchTitle').text(cellName == "" ? searchSet['searchName'] : cellName);
								} else {
									searchSelectEx.find('.searchTitle').text(searchSet['searchName']);
								}
							}
						});
						//選項
						for (let s = 0; s < searchSet['select'].length; s++) {
							let key = searchSet['select'][s].split("_")[0];
							let val = searchSet['select'][s].split("_")[1];
							selectEx = searchSelectEx.find('.selectEx').clone();
							selectEx.removeClass("selectEx");
							selectEx.removeAttr("selected");
							selectEx.text(key);
							selectEx.val(val);
							selectEx.appendTo(searchSelectEx.find('select'));
						}
					}
					switch (searchSet['type']) {
						case "select":
							searchSelectEx.appendTo('#searchItem');
							break;
						case "text":
							searchTextEx.appendTo('#searchItem');
							break;
						case "time":
							searchTextEx.find('input').addClass('datetimepicker_time');
							searchTextEx.appendTo('#searchItem');
							break;
						case "datetime":
							searchTextEx.find('input').addClass('datetimepicker_date');
							searchTextEx.appendTo('#searchItem');
							break;
					}
				}
				//Step5.帶入資料
				search.methods.searchReLoad();

				//==========================監聽==========================
				//監聽-選取資料(一般)
				$(document).off("change", "#search_c #search_cr_open .exTbodyTh input");
				$(document).on("change", "#search_c #search_cr_open .exTbodyTh input", function (event) {
					console.log("search_cr_open");
					//一般資料
					let Ikey_Gkey = event.target.title;
					let check = event.target.checked;
				});
				//監聽-選取資料(細節)
				$(document).off("change", "#search_c #search_dcr_open .exTbodyTh input");
				$(document).on("change", "#search_c #search_dcr_open .exTbodyTh input", function (event) {
					console.log("search_dcr_open");
					let Ikey_Gkey = event.target.title;
					let check = event.target.checked;
				});
				//監聽-全清除資料(一般)
				$(document).off("click", "#search_c #exthAll");
				$(document).on("click", "#search_c #exthAll", function (event) {
					//都有勾選?
					let clickAll = true;
					//全部取消?
					if (clickAll) {
						$("#search_cr_open .exTbodyTh").find("input").prop("checked", false);;
					}
				});
				//監聽-全清除資料(細節)
				$(document).off("click", "#search_c #exthDetailAll");
				$(document).on("click", "#search_c #exthDetailAll", function (event) {
					//都有勾選?
					let clickAll = true;
					//全部取消?
					if (clickAll) {
						$("#search_dcr_open .exTbodyTh").find("input").prop("checked", false);
					}
				});
				//選取BOM
				$(document).off("click", "#search_c #btn_bom");
				$(document).on("click", "#search_c #btn_bom", function (event) {
					//帶入BOM號
					console.log("btn_bom");
					let bom = $("#search_dcr_open .exTbodyTh").find("input:checked");
					let bom_n = bom.attr('alt').replace("row_", "");
					$("#sphbpmnb input").val($("#search_dcr_open .valTbodyDetailTr_" + bom_n + " .bpmnb").text());

				});
				//選取現存單據
				$(document).off("click", "#search_c #btn_order");
				$(document).on("click", "#search_c #btn_order", function (event) {
					console.log("btn_order");
					$("#sphpon").val($("#sphpon input").val());

					search.methods.searchSend(0, "order");
				});

				//監聽-建立
				$(document).off("click", "#search_c #btn_create");
				$(document).on("click", "#search_c #btn_create", function (event) {
					console.log("btn_create");
					search.methods.searchToModify("create");
				});
				//監聽-另存
				$(document).off("click", "#search_c #btn_saveAs");
				$(document).on("click", "#search_c #btn_saveAs", function (event) {
					console.log("btn_saveAs");
					search.methods.searchToModify("saveAs");
				});
				//監聽-修改
				$(document).off("click", "#search_c #btn_modify");
				$(document).on("click", "#search_c #btn_modify", function (event) {
					console.log("btn_modify");
					search.methods.searchToModify("modify");
				});
				//監聽-作廢
				$(document).off("click", "#search_c #btn_invalid");
				$(document).on("click", "#search_c #btn_invalid", function (event) {
					console.log("btn_invalid");
					search.methods.searchToModify("invalid");
				});
				//監聽-移除
				$(document).off("click", "#search_c #btn_delete");
				$(document).on("click", "#search_c #btn_delete", function (event) {
					console.log("btn_delete");
					search.methods.searchToModify("delete");
				});
				//監聽-標記移除
				$(document).off("click", "#search_c #btn_markCancel");
				$(document).on("click", "#search_c #btn_markCancel", function (event) {
					console.log("btn_markCancel");
					search.data.marks = [];
					search.data.markDetails = [];
					$('#search_c .exTbodyTh input').prop("checked", false);

				});
				//監聽-打印
				$(document).off("click", "#search_c #btn_printerForm");
				$(document).on("click", "#search_c #btn_printerForm", function (event) {
					console.log("btn_printerForm");

					// 獲取 #printNotes 的 HTML 內容
					const content = $("#printNotes").clone();
					content.children("div").first().css({
						transform: "scale(1.3)", /* 放大內容 25% */
						transformOrigin: "top left"
					});
					const contentHtml = content.html();

					// 開啟一個新視窗
					const printWindow = window.open("", "_blank", "width=800,height=800");

					// 在新視窗中寫入 HTML
					printWindow.document.open();
					printWindow.document.write("<!DOCTYPE html>" +
						"<html>" +
						"<head><title>打印內容</title>" +
						'<link rel="stylesheet" href="./thirdparty/css/jquery-ui-1.13.2.min.css" />' +
						'<link rel="stylesheet" href="./thirdparty/css/bootstrap-5.2.3.min.css" />' +
						'<link rel="stylesheet" href="./thirdparty/css/bootstrap-datetimepicker.min.css" />' +
						'<link rel="stylesheet" href="./thirdparty/bootstrap-icons-1.10.5/font/bootstrap-icons.min.css">' +
						"<style>" +
						'body {' +
						'width: 210mm; /* A4 寬度 */' +
						'height: 297mm; /* A4 高度 */' +
						' margin: 0;' +
						'padding: 0;' +
						'overflow: hidden;' +
						'font-family: Arial, sans-serif;' +
						'}' +
						"</style>" +
						"</head>" +
						"<body>" + contentHtml + "</body>" +
						"</html>");
					printWindow.document.close();
					// 等待新視窗加載完成後打印
					printWindow.onload = function () {
						printWindow.print();
						printWindow.close();
					};
				});
				//監聽-比對
				$(document).off("click", "#search_c #btn_compare");
				$(document).on("click", "#search_c #btn_compare", function (event) {
					console.log("btn_compare");
					search.methods.searchToCompare(null);

				});
				//監聽-查詢
				$(document).off("click", "#search_c #btn_send");
				$(document).on("click", "#search_c #btn_send", function (event) {
					console.log("btn_send");
					search.methods.searchSend(0, null);

					if ($("#btn_send_auto").prop("checked")) {
						search.data.btn_send_auto = setTimeout(function () {
							$("#search_c #btn_send").trigger("click");
						}, 30000);
					} else {
						clearTimeout(search.data.btn_send_auto);
					}
				});
				//監聽-查詢(促發)
				$(document).off("keyup", "#searchItem input");
				$(document).on("keyup", "#searchItem input", function (e) {
					if (e.key === 'Enter' || e.keyCode === 13) {
						$(e.currentTarget).select();
						$("#search_c #btn_send").trigger("click");
					}
				});
				//監聽-清除查詢
				$(document).off("click", "#search_c #btn_clearAll");
				$(document).on("click", "#search_c #btn_clearAll", function (event) {
					console.log("btn_clearAll");
					$("#searchItem input").val("");
					$("#searchItem select").val("");

				});

				//時間格式
				search.methods.datetimepickerDate();

			},
			datetimepickerDate() {
				//日期時間格式
				//$('.datetimepicker').remove();
				$('#search_c_item .datetimepicker_date').datetimepicker({
					format: 'yyyy-mm-dd hh:ii:00',
					pickerPosition: 'bottom-right',
					//minView:1,
					// hoursDisabled: [00, 1, 2, 3, 4, 5, 6],
					minuteStep: 30,
					autoclose: true,
					endDate: '+1d',
					datesDisabled: '+1d',
					todayBtn: true,
					bootcssVer: 5,
					//......可以同上項目代碼自定義設置
				});
				//時間格式
				$('#search_c_item .datetimepicker_time').datetimepicker({
					format: 'hh:ii',
					startView: 1,
					minuteStep: 30,
					pickDate: false,
					autoclose: true,
					timeFormat: 'hh:mm',
				});
			},
			//==========================修改資料==========================
			searchToModify(order) {
				//新建?
				if (order == "create") {
					modify.methods.modify(order, null, null);
					return null;
				}

				//是否marks?markDetails?
				let entityJsons = search.data.searchPageSet.entityJsons;
				let entityDetailJsons = search.data.searchPageSet.entityDetailJsons;
				let marks = search.data.marks;
				let markDetails = search.data.markDetails;
				let entityIKey = search.data.entityIKey;
				let entityGKey = search.data.entityGKey;
				let entityDateTime = search.data.entityDateTime;
				let dataHeader = [];
				let dataBody = [];
				console.log(JSON.stringify(marks));
				if (JSON.stringify(marks) == "{}" && JSON.stringify(markDetails) == "{}") {
					return null;
				}
				//Data
				Object.keys(marks).forEach(function (ik) {
					let ikey = ik.split("_")[0];
					let gkey = ik.split("_")[1];
					for (let en = 0; en < entityJsons.length; en++) {
						if (entityJsons[en][entityIKey] == ikey) {
							dataHeader.push(entityJsons[en]);
						}
					}
				});
				//Details
				Object.keys(markDetails).forEach(function (dk) {
					let ikey = dk.split("_")[0];
					let gkey = dk.split("_")[1];
					for (let en = 0; en < entityDetailJsons.length; en++) {
						if (entityDetailJsons[en][entityIKey] == ikey) {
							dataBody.push(entityDetailJsons[en]);
						}
					}
				});

				modify.methods.modify(order, dataHeader, dataBody);
			},

			//==========================傳送資料==========================
			searchSend(batch, order) {
				let entityJson = search.data.entityFormatJson;//格式
				let data = {};
				let req_data = {};
				let searchPageSet = {};
				//查詢
				$("#searchItem .searchVal").each(function (index) {
					console.log(index + " : " + $(this).attr("id") + " : " + $(this).val());
					if ($(this).hasClass('datetimepicker_date') && $(this).val() != "") {
						entityJson[$(this).attr("id")] = new Date($(this).val()).getTime();
					} else {
						entityJson[$(this).attr("id")] = $(this).val() == "" ? null : $(this).val();
					}
				});
				data['entityJson'] = JSON.stringify(entityJson);
				//換頁
				searchPageSet['total'] = search.data.searchPageSet.total;//批次數量
				searchPageSet['batch'] = batch;//第幾批次
				data['searchPageSet'] = JSON.stringify(searchPageSet);
				data['callBackFunction'] = "search";
				//包裝
				req_data['data'] = data;
				req_data['url'] = $('#nav_functional_unit').attr('title') + ".basil.AR";
				if (order != null) {
					req_data['url'] = $('#nav_functional_unit').attr('title') + ".basil.ARO";
				}
				req_data['type'] = "POST";
				main.methods.ajaxSend(req_data, true);
				//時間格式
				search.methods.datetimepickerDate();
			},
			//==========================資料載入==========================
			searchReLoad() {
				console.log("searchReLoad_Start:" + new Date());
				//還原
				$('#search_c .valTbodytd').text("");
				$('#search_c .exTbodyTh input').attr("disabled", "disabled");
				$('#search_c .exTbodyTh input').attr("title", "IKey_GKey");
				$('#search_c .exTbodyTh input').prop("checked", false);
				//版面預設
				if (!$('#search_dcr_open').hasClass('show')) {
					$('#search_dcr .btn-outline-white').trigger('click');
				}
				if (!$('#search_cr_open').hasClass('show')) {
					$('#search_cr .btn-outline-white').trigger('click');
				}

				//Step5.帶入資料
				let marks = search.data.marks;
				let entityJsons = search.data.searchPageSet.entityJsons;
				let entityDetailJsons = search.data.searchPageSet.entityDetailJsons;
				let entityIKey = search.data.entityIKey;
				let entityGKey = search.data.entityGKey;
				let entityDateTime = search.data.entityDateTime;
				let pageSize = search.data.searchPageSet.pageSize;//每頁數量(1-20)
				let pageNew = search.data.searchPageSet.pageNew - 1;//單前頁碼(1-50)
				let pageSN = pageSize * pageNew;//目前分頁->資料戳記
				for (let x = 0; x < pageSize; x++) {
					//筆數還夠
					if (pageSN + x < entityJsons.length) {
						let entity = entityJsons[pageSN + x];//((目前頁碼-1)*每頁數量)+x
						let iKey = "";
						let gKey = "";
						Object.keys(entity).forEach(function (k) {
							//欄位計數
							let valTrNb = x + 1;
							$('#search_c .valTbodyTr_' + valTrNb + ' th input').removeAttr("disabled");
							//是否IKEY?
							if (entityIKey == k) {iKey = entity[k];}
							//是否GKEY?
							if (entityGKey == k) {gKey = entity[k];}
							//是否時間格式?
							if (entityDateTime.indexOf(k) >= 0) {
								let dF = new Date(entity[k]);
								let dateF = dF.getFullYear() + "-";
								dateF += ((dF.getMonth() + 1) < 10 ? "0" + (dF.getMonth() + 1) : (dF.getMonth() + 1)) + "-";
								dateF += (dF.getDate() < 10 ? "0" + (dF.getDate()) : dF.getDate()) + " ";
								dateF += (dF.getHours() < 10 ? "0" + dF.getHours() : dF.getHours()) + ":";
								dateF += (dF.getMinutes() < 10 ? "0" + dF.getMinutes() : dF.getMinutes()) + ":";
								dateF += (dF.getSeconds() < 10 ? "0" + dF.getSeconds() : dF.getSeconds());
								$('#search_c .valTbodyTr_' + valTrNb + ' .' + k).text(dateF);
							} else {
								$('#search_c .valTbodyTr_' + valTrNb + ' .' + k).text(entity[k]);
							}

							//marks標記?
							$('#search_c .valTbodyTr_' + valTrNb + ' input').attr("title", iKey + "_" + gKey);
							//帶入
							for (let m = 0; m < marks.length; m++) {
								if (marks[m].Ikey_Gkey == iKey + "_" + gKey) {
									$('#search_c .valTbodyTr_' + valTrNb + ' input').prop("checked", true);
									break;
								}
							}
						});
					}
				}
				//下面清單
				for (let x = 0; x < pageSize; x++) {
					//筆數還夠
					if (pageSN + x < entityDetailJsons.length) {
						let entity = entityDetailJsons[pageSN + x];//((目前頁碼-1)*每頁數量)+x
						let iKey = "";
						let gKey = "";
						Object.keys(entity).forEach(function (k) {
							//欄位計數
							let valTrNb = x + 1;
							$('#search_c .valTbodyDetailTr_' + valTrNb + ' th input').removeAttr("disabled");
							//是否IKEY?
							if (entityIKey == k) {iKey = entity[k];}
							//是否GKEY?
							if (entityGKey == k) {gKey = entity[k];}
							//是否時間格式?
							if (entityDateTime.indexOf(k) >= 0) {
								let dF = new Date(entity[k]);
								let dateF = dF.getFullYear() + "-";
								dateF += ((dF.getMonth() + 1) < 10 ? "0" + (dF.getMonth() + 1) : (dF.getMonth() + 1)) + "-";
								dateF += (dF.getDate() < 10 ? "0" + (dF.getDate()) : dF.getDate()) + " ";
								dateF += (dF.getHours() < 10 ? "0" + dF.getHours() : dF.getHours()) + ":";
								dateF += (dF.getMinutes() < 10 ? "0" + dF.getMinutes() : dF.getMinutes()) + ":";
								dateF += (dF.getSeconds() < 10 ? "0" + dF.getSeconds() : dF.getSeconds());
								$('#search_c .valTbodyDetailTr_' + valTrNb + ' .' + k).text(dateF);
							} else {
								$('#search_c .valTbodyDetailTr_' + valTrNb + ' .' + k).text(entity[k]);
							}

							//marks標記?
							$('#search_c .valTbodyDetailTr_' + valTrNb + ' input').attr("title", iKey + "_" + gKey);
							//帶入
							for (let m = 0; m < marks.length; m++) {
								if (marks[m].Ikey_Gkey == iKey + "_" + gKey) {
									$('#search_c .valTbodyDetailTr_' + valTrNb + ' input').prop("checked", true);
									break;
								}
							}
						});
					}
				}


				console.log("searchReLoad_OK:" + new Date());
			},
			//==========================回傳接收==========================
			searchReturn() {
				//查詢回傳
				console.log("searchReturn:" + new Date());
				//Step4.分頁歸位
				if (main.resq_data['entityJson'].length > 0) {
					let searchPageSet = JSON.parse(main.resq_data['searchPageSet']);
					search.data.searchPageSet.total = searchPageSet['total'];
					search.data.searchPageSet.batch = searchPageSet['batch'];
					search.data.searchPageSet.pageNew = 1; //單前頁碼(1-50)
					search.data.marks = {};//有選取的IKeyGKey
					search.data.markDetails = {};//有選取的IKeyGKey

					//Step5.帶入資料
					if (main.resq_data['entityJson'] != "") {
						search.data.searchPageSet.entityJsons = JSON.parse(main.resq_data['entityJson']);

					}
					if (main.resq_data['entityDetailJson'] != "") {
						search.data.searchPageSet.entityDetailJsons = JSON.parse(main.resq_data['entityDetailJson']);
					}
					search.methods.searchReLoad();
				}
			},
			//==========================初始化==========================
			destroy() {
				//銷毀
				$(".datetimepicker").remove();
				$(document).off("click", "#search_c #btn_bom");
				$(document).off("click", "#search_c #btn_clearAll");
				$(document).off("keyup", "#searchItem input");
				$(document).off("click", "#search_c #btn_send");
				$(document).off("click", "#search_c #btn_compare");
				$(document).off("click", "#search_c #btn_printerForm");
				$(document).off("click", "#search_c #btn_markCancel");
				$(document).off("click", "#search_c #btn_delete");
				$(document).off("click", "#search_c #btn_invalid");
				$(document).off("click", "#search_c #btn_modify");
				$(document).off("click", "#search_c #btn_saveAs");
				$(document).off("click", "#search_c #btn_create");
				$(document).off("click", "#search_c #exthDetailAll");
				$(document).off("click", "#search_c #exthAll");
				//
				$(document).off("change", "#search_c #search_dcr_open .exTbodyTh input");
				$(document).off("change", "#search_c #search_cr_open .exTbodyTh input");
				console.log("search.html(destroy)");
			},
		},
	};
</script>